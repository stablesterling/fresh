<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VoFo Music Player</title>
    <style>
        body { background: #0d0d0d; color: #e5e5e5; font-family: sans-serif; padding: 20px; }
        .track { display: flex; align-items: center; gap: 15px; padding: 10px; border-bottom: 1px solid #222; cursor: pointer; }
        .track:hover { background: #1a1a1a; }
        .track img { width: 50px; height: 50px; border-radius: 4px; }
        #player-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: #000; padding: 15px; border-top: 1px solid #c5a367; display: none; }
    </style>
</head>
<body>

    <h2>VoFo Music</h2>
    <input id="q" type="text" placeholder="Search music...">
    <button onclick="doSearch()">Search</button>
    <div id="results"></div>

    <div id="player-bar">
        <span id="pTitle">Select a song</span>
        <audio id="audioPlayer" controls autoplay style="width: 100%; margin-top: 10px;"></audio>
    </div>

    <script>
        async function doSearch() {
            const q = document.getElementById('q').value;
            const res = await fetch(`/api/search?q=${q}`);
            const data = await res.json();
            const list = document.getElementById('results');
            list.innerHTML = data.map(s => `
                <div class="track" onclick="playTrack('${s.id}', '${s.title}')">
                    <img src="${s.thumbnail}">
                    <div>${s.title}</div>
                </div>
            `).join('');
        }

        async function playTrack(id, title) {
            document.getElementById('player-bar').style.display = 'block';
            document.getElementById('pTitle').innerText = "Loading: " + title;
            
            const res = await fetch(`/api/stream?id=${id}`);
            const data = await res.json();
            
            if(data.url) {
                const player = document.getElementById('audioPlayer');
                player.src = data.url;
                player.play();
                document.getElementById('pTitle').innerText = "Playing: " + title;
            }
        }
    </script>
</body>
</html>
